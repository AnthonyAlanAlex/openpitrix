# +-------------------------------------------------------------------------
# | Copyright (C) 2017 Yunify, Inc.
# +-------------------------------------------------------------------------
# | Licensed under the Apache License, Version 2.0 (the "License");
# | you may not use this work except in compliance with the License.
# | You may obtain a copy of the License in the LICENSE file, or at:
# |
# | http://www.apache.org/licenses/LICENSE-2.0
# |
# | Unless required by applicable law or agreed to in writing, software
# | distributed under the License is distributed on an "AS IS" BASIS,
# | WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# | See the License for the specific language governing permissions and
# | limitations under the License.
# +-------------------------------------------------------------------------

# --------------------------------------------------------------------------
# App
# --------------------------------------------------------------------------

# type App struct {
#   appId       string     `required pattern="app-[a-zA-Z0-9]{11}", minLength=12, maxLength=12`
#   name        *string    `optional`
#   description *string    `optional`
#   createTime  *time.Time `optional`
# }

App:
  required:
    - appId
  properties:
    name:
      type: string
    description:
      type: string
    url:
      type: string
    appId:
      type: string
      pattern: 'app-[a-zA-Z0-9]{11}'
      minLength: 12
      maxLength: 12
    createTime:
      type: string
      format: date-time
      readOnly: true
      example: 2017-09-17T12:36:58.014Z

# type Apps []App

Apps:
  properties:
    items:
      type: array
      uniqueItems: true
      items:
        $ref: 'types.yaml#/App'

# --------------------------------------------------------------------------
# Cluster
# --------------------------------------------------------------------------

Cluster:
  required:
    - clusterId
  properties:
    name:
      type: string
    description:
      type: string
    clusterId:
      type: string
      pattern: 'cl-[a-zA-Z0-9]{11}'
      minLength: 11
      maxLength: 11
    createTime:
      type: string
      format: date-time
      readOnly: true
      example: 2017-09-17T12:36:58.014Z

Clusters:
  properties:
    items:
      type: array
      uniqueItems: true
      items:
        $ref: 'types.yaml#/Cluster'

# --------------------------------------------------------------------------
# Repo
# --------------------------------------------------------------------------

Repo:
  required:
    - repoId
  properties:
    name:
      type: string
    description:
      type: string
    url:
      type: string
    repoId:
      type: string
      pattern: 'repo-[a-zA-Z0-9]{11}'
      minLength: 13
      maxLength: 13
    createTime:
      type: string
      format: date-time
      readOnly: true
      example: 2017-09-17T12:36:58.014Z

Repos:
  properties:
    items:
      type: array
      uniqueItems: true
      items:
        $ref: 'types.yaml#/Repo'

# --------------------------------------------------------------------------
# AppRuntime
# --------------------------------------------------------------------------

AppRuntime:
  required:
    - appRuntimeId
  properties:
    name:
      type: string
    description:
      type: string
    url:
      type: string
    appRuntimeId:
      type: string
      pattern: 'rt-[a-zA-Z0-9]{11}'
      minLength: 11
      maxLength: 11
    createTime:
      type: string
      format: date-time
      readOnly: true
      example: 2017-09-17T12:36:58.014Z

AppRuntimes:
  properties:
    items:
      type: array
      uniqueItems: true
      items:
        $ref: 'types.yaml#/AppRuntime'

# --------------------------------------------------------------------------
# Paging
# --------------------------------------------------------------------------

Paging:
  properties:
    totalItems:
      type: integer
    totalPages:
      type: integer
    pageSize:
      type: integer
    currentPage:
      type: integer

# --------------------------------------------------------------------------
# Error
# --------------------------------------------------------------------------

Error:
  properties:
    code:
      type: string
      enum:
        - DBERR
        - NTERR
        - UNERR
    message:
      type: string

# --------------------------------------------------------------------------
# parameters
# --------------------------------------------------------------------------

parameters:
  pageSize:
    name: pageSize
    in: query
    description: Number of clusters returned
    type: integer
    format: int32
    minimum: 0
    exclusiveMinimum: true
    exclusiveMaximum: false
    multipleOf: 10
    default: 20
  pageNumber:
    name: pageNumber
    in: query
    description: Page number
    type: integer
    default: 1
  appId:
    name: appId
    in: path
    required: true
    description: The app's id
    type: string
  clusterId:
    name: clusterId
    in: path
    required: true
    description: The cluster's id
    type: string
  repoId:
    name: repoId
    in: path
    required: true
    description: The repo's id
    type: string
  appRuntimeId:
    name: appRuntimeId
    in: path
    required: true
    description: The app runtime's id
    type: string

# --------------------------------------------------------------------------
# responses
# --------------------------------------------------------------------------

responses:
  Standard500ErrorResponse:
    description: An unexpected error occured.
    schema:
      $ref: 'types.yaml#/Error'
  ClusterDoesNotExistResponse:
    description: The cluster does not exist.
  RepoDoesNotExistResponse:
    description: The repo does not exist.
  AppRuntimeDoesNotExistResponse:
    description: The app runtime does not exist.
  AppDoesNotExistResponse:
    description: The app does not exist.

# --------------------------------------------------------------------------
# END
# --------------------------------------------------------------------------
